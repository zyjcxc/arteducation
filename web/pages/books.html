<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>全国特长生认证委员会</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="全国特长生认证委员会">
    <meta name="keywords" content="全国特长生认证委员会">
	<script type="text/javascript" src="../utils/jquery-3.3.1.min.js"></script>
	<link rel="stylesheet" href="../css/style.css">


</head>

<body>

<div class="page-list">
   <!------------ 注释：顶部 start ----------->
	<div id="header-page"></div>
	<!------------ 注释：顶部 end ----------->
	<!------------ 注释：面包屑 start ----------->
	<div class="detail-top">
		<div class="contain">
			<div class="nav-label visible-md-block visible-lg-block visible-sm-block">
				<span id="nav-label"></span>
			</div>
			<ul id="breadcrumb" class="breadcrumb">

			</ul>
		</div>

	</div>


	<div class="contain books">
		<div class="sidebar visible-md-block visible-lg-block visible-sm-block">
			<ul id="menu_sidebar">

			</ul>
		</div>
		<ul id="menu_sidebar_xs" class="nav nav-tabs visible-xs-block">
		</ul>
		<div class="content">
			 <h2 class="visible-md-block visible-lg-block visible-sm-block">使用教材</h2>
			 <ul class="item-list">


			 </ul>
		</div>

	</div>

    <!------------ 注释：底部 start ----------->
	<div id="footer-page"></div>
	<!------------ 注释：底部 start ----------->

</div>

<!--ajax封装-->
<script type="text/javascript" src="../js/extend.js"></script>
<!--通用：包括config，公共头底页面，面包屑及目录-->
<script type="text/javascript" src="../js/common.js"></script>
<script type="text/javascript">
    var page_num = 1;
    var page_size = 10;
    var path = {},id = null;
    function getList(num) {
        $.EXTEND.GET('artTextbook',{offset:( num - 1 )*page_size,textbookTypeId:id})
            .then(function (res) {
                var str1 = '';
                $.each(res.data, function(i, item) {
                    str1 +=
                        '<li>' +
							'<a target="_blank" href="../pages/detail/book_detail.html?id=' +item.id+ '">' +
								'<img src="' +item.picUrl+ '" alt="" />' +
								'<p>' +item.title+ '</p>' +
							'</a>' +
						'</li>';
                });
                $(".item-list").html(str1);
                page(Math.ceil(res.recordsTotal / page_size));
            });
    }
    function page(total) {
        $("#pagination").pagination({
            currentPage: page_num,
            totalPage: total,
            isShow: true,
            homePageText: "首页",
            endPageText: "尾页",
            prevPageText: "上一页",
            nextPageText: "下一页",
            callback: function(current) {
                $("#current3").text(current);
                page_num = current;
                getList(current)
            }
        });
    }
    function findPath(array){
        for (var i = 0; i < array.length; i++) {
            var item = array[i]
            if(item.isParent){
                for (var i = 0; i < item.children.length; i++){
                    if(item.children[i].url == (path.pathname + searchUrl)){
                        return item;
                        break;
                    }
                }
                return false;
            }else if(item.url == (path.pathname + searchUrl)){
                return item
                break;
            }
        };
    }

    function initCrumb(res){
        $("#nav-label").html('使用教材');
        var li = '<li>首页</li><li>' + '使用教材' + '</li>';
        for (var i = 0; i < res.length; i++) {
            var item = res[i];
            if(item.id == id){
                li = li + '<li>' + item.name + '</li>';
                break;
            }

        };
        $("#breadcrumb").html(li);

    }

    function initMenu(){
        var li = '',li_xs = '';
        $.EXTEND.GET('artTextbookType/findAll')
            .then(function (res) {
                path = {
                    href:window.location.href,
                    pathname:window.location.pathname.split('/pages/')[1],
                    search:window.location.search.split('?')[1]
                };
                id = path.search ? path.search.split('_')[1] : res[0].id ;
                for (var i = 0; i < res.length; i++) {
                    var item = res[i];

                    var className = (item.id == id) ?'active':'';
                    li = li + '<li class="' + className + '"><a href="../pages/books.html?book_' + item.id + '">' + item.name + '</a></li>';
                    li_xs = li_xs +
                        '<li role="presentation" class="' + className + '"><a href="../pages/books.html?book_' + item.id + '">' + item.name + '</a></li>';
                }
                $("#menu_sidebar").html(li);
                $("#menu_sidebar_xs").html(li_xs);
                init(res)
            });


    }
    function init(res) {
        initCrumb(res);
        getList(page_num);
    }
    initMenu()
</script>

</body>

</html>